## 리뷰
- 스파크의 optimizer 2가지 - Catalyst Optimizer와 AQE를 배웠다. 지난 주에는 개발자 입장에서 고려해야 할 optimization을 배웠다면, 오늘 배운 optimizer는 스파크가 자동적으로 optimization을 실행하는 경우에 해당했다.
- Catalyst Optimizer가 동작하는 순서가 파싱->logical optimization->physical optimization->code generation으로 이뤄져 있다.
- AQE는 query stage 단위로 실행 시키다가 통계가 나오면, 그 통계를 기반으로 플랜이 최적인지 평가한다.
- AQE가 사용되는 3가지 상황을 배웠다. 첫째로, shuffle이 일어난 후의 partition 수를 줄여 reducer 수를 줄임으로써 스케줄링 오버헤드를 줄인다. 둘째로, 실제 실행 결과 데이터 사이즈를 이용해서, sortMergeJoin을 broadcast-hashJoin으로 바꾸는 등 조인 전략을 변경한다. 셋째로, partition에 불균형이 일어난 경우, partition을 쪼개는 작업을 처리한다.
- join하기 전에 shuffle해야 하는 이유를 알게 됐다. map-reduce 작업이 1번만에 끝나야 하기 때문이었다.
- 최종 프로젝트 관련해서, '누구의 어떤 문제'를 수정했다. 기존에는 자율주행 택시의 공차 시 행선지를 알려주는 서비스였는데, 콜 기반 방식과 거리 탑승 방식을 모두 고려해야 해서 문제가 복잡해지는 점이 있었다. 그래서 거리 탑승만을 기반으로 한 택시 회사로 '누구의'를 수정했다.
- 새로 만들어진 문제를 구체화하고, 파이프라인을 설계해봤다.
## 회고
- Keep: 일주일밖에 안 남았으니 조금만 더 고생하기
